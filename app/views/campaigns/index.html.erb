<div class="min-h-screen bg-gray-50">
  <!-- Navigation Bar -->
  <nav class="bg-white shadow">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex items-center space-x-8">
          <div class="flex-shrink-0">
            <h1 class="text-xl font-bold text-gray-900"><%= @advertiser.name %></h1>
          </div>
          <div class="flex space-x-4">
            <%= link_to "Dashboard", advertiser_dashboard_path(@advertiser.slug), class: "text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium" %>
            <%= link_to "Campaigns", campaigns_path(@advertiser.slug), class: "text-indigo-600 border-b-2 border-indigo-600 px-3 py-2 text-sm font-medium" %>
            <%= link_to "Team", advertiser_team_path(@advertiser.slug), class: "text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium" %>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <div class="flex items-center space-x-2">
            <div class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 text-sm font-bold">
              <%= current_user.initials %>
            </div>
            <span class="text-sm text-gray-700"><%= current_user.display_name %></span>
          </div>
          <%= button_to "Sign Out", destroy_user_session_path, method: :delete,
              data: { turbo: false },
              class: "text-sm font-medium text-gray-700 hover:text-gray-900" %>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
    <!-- Flash Messages -->
    <% if notice %>
      <div class="mb-6 bg-green-50 border border-green-200 rounded-md p-4">
        <div class="flex">
          <div class="flex-shrink-0">
            <svg class="h-5 w-5 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
            </svg>
          </div>
          <div class="ml-3">
            <p class="text-sm font-medium text-green-800"><%= notice %></p>
          </div>
        </div>
      </div>
    <% end %>

    <% if alert %>
      <div class="mb-6 bg-red-50 border border-red-200 rounded-md p-4">
        <div class="flex">
          <div class="flex-shrink-0">
            <svg class="h-5 w-5 text-red-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
            </svg>
          </div>
          <div class="ml-3">
            <p class="text-sm font-medium text-red-800"><%= alert %></p>
          </div>
        </div>
      </div>
    <% end %>

    <!-- Header -->
    <div class="mb-6 sm:flex sm:items-center sm:justify-between">
      <div>
        <h1 class="text-2xl font-bold text-gray-900">Campaigns</h1>
        <p class="mt-1 text-sm text-gray-500">Create and manage your postcard campaigns</p>
      </div>
      <div class="mt-4 sm:mt-0">
        <%= link_to new_campaign_path(@advertiser.slug), class: "inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" do %>
          <svg class="-ml-1 mr-2 h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" />
          </svg>
          Create Campaign
        <% end %>
      </div>
    </div>

    <!-- Filter Tabs -->
    <div class="bg-white shadow sm:rounded-lg mb-6">
      <div class="border-b border-gray-200">
        <nav class="-mb-px flex space-x-8 px-6" aria-label="Tabs">
          <%= link_to "All", campaigns_path(@advertiser.slug), 
              class: "#{params[:status].blank? ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" %>
          <%= link_to "Drafts", campaigns_path(@advertiser.slug, status: 'draft'), 
              class: "#{params[:status] == 'draft' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" %>
          <%= link_to "Completed", campaigns_path(@advertiser.slug, status: 'completed'), 
              class: "#{params[:status] == 'completed' ? 'border-indigo-500 text-indigo-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm" %>
        </nav>
      </div>

      <!-- Campaigns List -->
      <div class="divide-y divide-gray-200">
        <% if @campaigns.any? %>
          <% @campaigns.each do |campaign| %>
            <div class="p-6 hover:bg-gray-50">
              <div class="flex items-center justify-between">
                <div class="flex-1 min-w-0">
                  <div class="flex items-center space-x-3">
                    <h3 class="text-lg font-medium text-gray-900 truncate">
                      <%= link_to campaign.name, campaign_path(@advertiser.slug, campaign), class: "hover:text-indigo-600" %>
                    </h3>
                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= 
                      case campaign.status
                      when 'draft' then 'bg-gray-100 text-gray-800'
                      when 'completed' then 'bg-green-100 text-green-800'
                      when 'completed_with_errors' then 'bg-yellow-100 text-yellow-800'
                      when 'processing' then 'bg-blue-100 text-blue-800'
                      when 'failed' then 'bg-red-100 text-red-800'
                      when 'cancelled' then 'bg-gray-100 text-gray-800'
                      else 'bg-gray-100 text-gray-800'
                      end
                    %>">
                      <%= campaign.status == 'completed_with_errors' ? 'Completed (with errors)' : campaign.status.titleize %>
                    </span>
                  </div>
                  
                  <div class="mt-2 flex items-center text-sm text-gray-500 space-x-4">
                    <span>Created <%= time_ago_in_words(campaign.created_at) %> ago</span>
                    <span>•</span>
                    <span><%= campaign.recipient_count %> recipients</span>
                    <% if campaign.successfully_sent? %>
                      <span>•</span>
                      <span><%= number_to_currency(campaign.actual_cost_dollars) %></span>
                    <% elsif campaign.estimated_cost_cents > 0 %>
                      <span>•</span>
                      <span>Est. <%= number_to_currency(campaign.estimated_cost_dollars) %></span>
                    <% end %>
                  </div>

                  <% if campaign.successfully_sent? %>
                    <div class="mt-2 flex items-center text-sm space-x-4">
                      <span class="text-green-600"><%= campaign.delivered_count %> delivered</span>
                      <% if campaign.sent_count > campaign.delivered_count %>
                        <span class="text-yellow-600"><%= campaign.sent_count - campaign.delivered_count %> in transit</span>
                      <% end %>
                      <% if campaign.failed_count > 0 %>
                        <span class="text-red-600"><%= campaign.failed_count %> failed</span>
                      <% end %>
                    </div>
                  <% end %>
                </div>

                <div class="flex items-center space-x-3">
                  <% if campaign.draft? %>
                    <%= link_to "Continue Editing", edit_campaign_path(@advertiser.slug, campaign), class: "inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
                    <%= button_to "Delete", campaign_path(@advertiser.slug, campaign), method: :delete, data: { turbo_confirm: "Are you sure you want to delete this campaign?" }, class: "inline-flex items-center px-3 py-2 border border-red-300 shadow-sm text-sm leading-4 font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500" %>
                  <% else %>
                    <%= link_to "View Details", campaign_path(@advertiser.slug, campaign), class: "inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
                  <% end %>
                </div>
              </div>
            </div>
          <% end %>
        <% else %>
          <div class="p-12 text-center">
            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 19v-8.93a2 2 0 01.89-1.664l7-4.666a2 2 0 012.22 0l7 4.666A2 2 0 0121 10.07V19M3 19a2 2 0 002 2h14a2 2 0 002-2M3 19l6.75-4.5M21 19l-6.75-4.5M3 10l6.75 4.5M21 10l-6.75 4.5m0 0l-1.14.76a2 2 0 01-2.22 0l-1.14-.76" />
            </svg>
            <h3 class="mt-2 text-sm font-medium text-gray-900">No campaigns</h3>
            <p class="mt-1 text-sm text-gray-500">Get started by creating a new campaign.</p>
            <div class="mt-6">
              <%= link_to "Create Campaign", new_campaign_path(@advertiser.slug), class: "inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Pagination -->
    <% if @campaigns.total_pages > 1 %>
      <div class="bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6 rounded-lg shadow">
        <%= paginate @campaigns %>
      </div>
    <% end %>
  </div>
</div>

